\documentclass[12pt, oneside]{article}

%Codificación e idioma
\usepackage[T1]{fontenc}
\usepackage[spanish]{babel}
\usepackage[utf8]{inputenc}

% Url
\usepackage{url}

% Graphics
\usepackage[pdftex]{graphicx}
\DeclareGraphicsExtensions{.png,.jpg}

\usepackage{wrapfig}

% Soporte multicolumna
\usepackage{multicol}

%Resaltado de sintaxis
\usepackage{color}
\definecolor{gray97}{gray}{.97}
\definecolor{gray75}{gray}{.75}
\definecolor{gray45}{gray}{.45}

\definecolor{red}{rgb}{0.6,0,0} % strings
\definecolor{green}{rgb}{0.25,0.5,0.35} % comments
\definecolor{purple}{rgb}{0.5,0,0.35} % keywords
\definecolor{blue}{rgb}{0.25,0.35,0.75} % doc

\usepackage{listings}
\lstset {
	frame				=	Ltb,
    framerule			=	0pt,
    aboveskip			=	0.5cm,
    framextopmargin		=	3pt,
    framexbottommargin	=	3pt,
    framexleftmargin	=	0.4cm,
    framesep			=	0pt,
    rulesep				=	.4pt,
    backgroundcolor		=	\color{gray97},
    rulesepcolor		=	\color{black},
    %
    stringstyle			=	\color{red},
    showstringspaces	=	false,
    basicstyle			=	\ttfamily\small,
    commentstyle		=	\color{green},
    morecomment         =   [s][\color{blue}]{/*}{*/},
    keywordstyle		=	\color{purple}\bfseries,
    tabsize					=	3,
    %
    numbers				=	left,
    numbersep			=	15pt,
    numberstyle			=	\tiny,
    numberfirstline		=	false,
    breaklines			=	true,
}

\title{Apache Torque}
\author{
	Francisco J. Serrano\\
	Benjamín Fernández\\
	Juan María Frías\\
	David Doña\\
	Enrique Ríos
}

\begin{document}

% Portada
\begin{titlepage}
	\maketitle
\end{titlepage}

% Indice generado
\tableofcontents
\newpage

\section{Introducción}
	\subsection{Fundación Apache}
		\input{inc/introduccion.fundacion-apache}

	\subsection{Apache Torque}
		\input{inc/introduccion.apache-torque}

\section{Gestores de bases de datos}

	\subsection{Postgresql}
		\input{inc/dbms.postgresql}

	\subsection{MySQL}
		\input{inc/dbms.mysql}
	
	\subsection{SQL Server}
		\input{inc/dbms.sqlserver}

\section{Instalando y configurando Apache Torque con Postgresql}
	\input{inc/ic-postgresql}

	\subsection{Instalando Ant}
		\input{inc/ic-postgresql.instalar-ant}

	\subsection{Creando un proyecto}
		\input{inc/ic-postgresql.crear-proyecto}

	\subsection{Configurando y ejecutando Generator}
		\input{inc/ic-postgresql.configurar-ejecutar-generator}

		\subsubsection{Editando build.propierties}
			\input{code/build.propierties}

		\subsubsection{Editando coches-schema.xml}
			\input{code/coches-schema}

	\subsection{Configuración del proyecto desde Eclipse}
		\input{inc/ic-postgresql.configurar-proyecto-eclipse}
	
\section{Instalando y cofigurando Apache Torque con MySQL}
	\input{inc/ic-mysql}
La instalación bajo MySQL es muy parecida a la de Postgresql. A continuación se detallan los cambios y diferencias respecto a la instalación sobre Postgresql.

\subsection{Configuración y ejecución de Generator}
El driver JDBC de la base de datos que descargamos en esta ocasión es para MySQL, desde la siguiente dirección: \url{http://dev.mysql.com/downloads/connector/j/} y lo introducimos en la carpeta {\em lib} de Generator.

En la edición del archivo build.propierties, se realizan las siguientes modificaciones:
\input{code/build.propierties-mysql}

\subsection{Configuración del proyecto desde eclipse}
Las propiedades del archivo Torque.properties son como siguen para MySQL:

\input{code/torque.properties-mysql}

En este caso, en driver que hay que añadir a nuestro proyecto eclipse es el siguiente:
\begin{lstlisting}
coches\orque-gen-3.3\lib
\end{lstlisting}

\begin{center}
	\includegraphics{img/mysql-file.png}
\end{center}

\section{Instalando y cofigurando Apache Torque con Microsoft SQL Server}
Para la instalación con MS SQL Server habrá que crear un nuevo usuario, o dar permisos a uno ya existente para el acceso a la base de datos que estemos utilizando. Este usuario debe tener la autenticación de SQL Server y el rol db\_ owner. Hay varios drivers disponibles para este tipo de base de datos, como jTDS y uno propio de MS SQL Server disponible desde su página de descargas. En esta guía explicaremos como utilizar jTDS.

\subsection{Configuración y ejecución de Generator}
En la edición del archivo build.propierties, se realizan las siguientes modificaciones:

\input{code/build.propierties-sqlserver}

\subsection{Configuración del proyecto desde eclipse}
Las propiedades del archivo Torque.properties son de la siguiente forma en MS SQL Server:
\input{code/torque.properties-sqlserver}

Por último se añade el driver de la base de datos a nuestro proyecto en Eclipse, situado en:
\begin{lstlisting}
coches\torque-gen-3.3\lib
\end{lstlisting}

%Falta imagen del conector java

Notas acerca el archivo de esquema XML:

Hay que tener cuidado con el uso de palabras clave de MS SQL en tablas y columnas. 
MS SQL admite poner el atributo {\em defaultIdMethod = “native”} para generar los campos automáticamente.

\section{Configuración del archivo schema.xml}
	\input{inc/configurar-schema}

	\subsection{Elemento Database}
		\input{inc/configurar-schema.database}

		\subsubsection{External-schema}
			\input{inc/configurar-schema.database.external-schema}

		\subsubsection{Domain}
			\input{inc/configurar-schema.database.domain}

		\subsubsection{Table}
			\input{inc/configurar-schema.database.table}

			\paragraph{Column}
				\input{inc/configurar-schema.database.table.column}

			\paragraph{Foreing-key}
				\input{inc/configurar-schema.database.table.foreing-key}

			\paragraph{Index}
				\input{inc/configurar-schema.database.table.index}

				\subparagraph{Index-column}
					\input{inc/configurar-schema.database.table.index.index-column}

\section{Funcionamiento de las clases generadas}
	\subsection{Usando el objeto}
		\input{inc/use-torque.object}

	\subsection{Insertando filas}
		\input{inc/use-torque.insert}

	\subsection{Usando la clase estática}
		\input{inc/use-torque.static-class}

	\subsection{Seleccionando filas}
		\input{inc/use-torque.select}

	\subsection{Actualizando filas} 
		\input{inc/use-torque.update}

	\subsection{Eliminando filas}
		\input{inc/use-torque.delete}

\section{Aplicacion}
\subsection{Esquema base datos}
\input{code/notas-schema}

\end{document}
